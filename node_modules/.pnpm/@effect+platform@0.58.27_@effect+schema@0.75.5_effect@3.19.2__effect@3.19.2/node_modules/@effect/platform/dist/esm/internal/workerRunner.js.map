{"version":3,"file":"workerRunner.js","names":["Schema","Serializable","Cause","Chunk","Context","Effect","Either","ExecutionStrategy","Exit","Fiber","identity","pipe","Layer","Option","Queue","Scope","Stream","Transferable","isWorkerError","WorkerError","PlatformRunnerTypeId","Symbol","for","PlatformRunner","GenericTag","make","process","options","gen","_","scope","fork","parallel","fiber","getOrThrow","getCurrentFiber","shutdown","zipRight","close","void","interruptFork","platform","backing","start","extend","fiberMap","Map","take","queue","decode","flatMap","msg","req","succeed","map","data","tap","portId","id","get","interrupt","collector","unsafeMakeCollector","sync","stream","effect","isEffect","transfers","encodeOutput","provideService","Collector","payload","send","unsafeRead","chunks","undefined","toReadonlyArray","unsafeClear","forEach","option","push","orDie","transfer","runDrain","andThen","traceId","spanId","sampled","withParentSpan","_tag","context","empty","catchIf","error","encodeCause","fail","onExit","exit","match","failureOrCause","cause","onLeft","encodeError","catchAllCause","onRight","ensuring","delete","set","forever","forkIn","layer","scopedDiscard","makeSerialized","schema","handlers","parseRequest","decodeUnknown","request","result","isLayer","buildWithScope","merge","provide","provideContext","message","mapError","reason","serializeFailure","serializeSuccess","layerSerialized"],"sources":["../../../src/internal/workerRunner.ts"],"sourcesContent":[null],"mappings":"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","ignoreList":[]}